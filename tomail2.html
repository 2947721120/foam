<html>
 <head>
  <link rel="stylesheet" type="text/css" href="foam.css" />
  <script language="javascript" src="bootFOAM.js"></script>
  <title>Takeout Mail Reader</title>
 </head>
<body>

<div id="header" style="position:absolute;background-color:#FFA500;">
<h1 style="margin-bottom:0;">Takeout Mail Reader</h1>
</div>

<div id="search" style="background-color:#FFD700;position:absolute;float:left;">
  <div id="textSearch"></div>
  <div id="toSearch"></div>
  <div id="fromSearch"></div>
  <div id="labelSearch"></div>
</div>

<div id="browse" style="position:absolute;background-color:#EEEEEE;float:left;">
Table Browser
</div>

<div id="edit" style="position:absolute;background-color:#EEEE99;float:left;">
View/Edit Here
</div>

<div id="footer" style="position:absolute;background-color:#FFA500;text-align:left;">
FOAM Powered
</div>

<script>
var header = document.getElementById('header');
var footer = document.getElementById('footer');
var search = document.getElementById('search');
var browse = document.getElementById('browse');
var edit   = document.getElementById('edit');

var toSearch   = document.getElementById('toSearch');
var fromSearch = document.getElementById('fromSearch');
var labelSearch = document.getElementById('labelSearch');

function toNum(p) { return p.replace ? parseInt(p.replace('px','')) : p; };

function pos(e, top, left, width, height) {
  var s = e.style;

  top != null && (e.style.top = toNum(top) + 'px');
  left != null && (e.style.left = toNum(left) + 'px');
  width != null && (e.style.width = toNum(width) + 'px');
  height != null && (e.style.height = toNum(height) + 'px');
}

var MIN_THREE_COLUMN_W = 1600;

function layout() {
  var W         = window.innerWidth - 15;
  var H         = window.innerHeight-5;
  var HEADER_H  = 60;
  var FOOTER_H  = 30;
  var SEARCH_W  = 500;
  var SEARCH_H  = H - HEADER_H - FOOTER_H;
  var RIGHT_W   = W - SEARCH_W - 5;

  pos(header,null,null,W,HEADER_H-10);
  pos(search, HEADER_H, null, SEARCH_W, SEARCH_H);

  if ( W > MIN_THREE_COLUMN_W ) {
    pos(browse, HEADER_H, SEARCH_W + 10, RIGHT_W * 0.6, SEARCH_H);
    pos(edit, HEADER_H, SEARCH_W + 10 + RIGHT_W * 0.6, RIGHT_W * 0.4, SEARCH_H);
  } else {
    pos(browse, HEADER_H, SEARCH_W + 10, RIGHT_W, SEARCH_H/2);
    pos(edit,
      toNum(browse.style.top) + toNum(browse.style.height) + 5,
      SEARCH_W + 10,
      RIGHT_W,
      SEARCH_H / 2 -5);
  }
  pos(footer, H-FOOTER_H, null, W, FOOTER_H);
}

window.onresize = layout;
layout();
</script>

  <script language="javascript">
    var dao = StorageDAO2.create({model: EMail});

    var table = ScrollBorder.create({
      view: TableView2.create({
        model: EMail,
        dao: dao,
        rows: 20
      }),
      dao: dao,
    });
    var byTo = GroupBySearchView.create({size: 12, dao: dao, property: EMail.TO});
    var byFrom = GroupBySearchView.create({size: 12, dao: dao, property: EMail.FROM});
    var byLabel = GroupBySearchView.create({size: 8, dao: dao, property: EMail.LABELS});

    browse.innerHTML = table.toHTML();
    toSearch.innerHTML = byTo.toHTML();
    fromSearch.innerHTML = byFrom.toHTML();
    labelSearch.innerHTML = byLabel.toHTML();

    table.initHTML();

    table.view.selection.addListener(function (src, property, oldValue, newValue) {
       if ( ! newValue ) return;
       var editView = SummaryView.create(table.view.selection);
       editView.model = EMail;
       edit.innerHTML = editView.toHTML();
       editView.initHTML();
    });

    table.view.selection.set(table.view.objs[0]);

    byFrom.initHTML();
    byTo.initHTML();
    byLabel.initHTML();
  </script>

</body>
</html>
