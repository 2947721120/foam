<html>
 <head>
  <link rel="stylesheet" type="text/css" href="foam.css" />
  <script language="javascript" src="bootFOAM.js"></script>
  <title>Chaos Mail</title>
 </head>
 <body>
  <script language="javascript">
    var i = window.location.search.indexOf('user=');
    GLOBAL.user = ( i == -1 ) ? '"Kevin Greer" <kgr@domain.com>' : window.location.search.substring(i+5);

    var ModelDAO = ModelDAO.create(this, StorageDAO2.create({ model: Model }));

    // This doesn't work, some async weirdness going on
    EMailDAO = EMailDAO.where(EQ(EMail.TO, user));

    var stack = StackView.create();
    stack.write(document);

    FOAM.browse(EMail);
  </script>
 </body>
</html>
