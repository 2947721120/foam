<html>
 <head>
  <link rel="stylesheet" type="text/css" href="..//core/foam.css" />
  <script>var FOAM_BOOT_DIR="../core/";</script>
  <script language="javascript" src="../core/bootFOAM.js"></script>
  <script language="javascript" src="dragon.js"></script>
  <title>FOAM DOM Objects</title>
  <style>
    h3 {color: #444;}
    .code {width:700px; white-space: pre; border: 1px solid; padding: 5px; font-family: monospace;}
    .output {width:700px; white-space: pre; border: 1px solid; padding: 5px; color: blue;}
    .error {border: 2px solid red;}
  </style>
 </head>

 <body>

<script language="javascript">
FOAModel({
  name: 'DemoView',
  extendsModel: 'DetailView',
  templates: [ { name: 'toHTML' } ]
});
</script>

<!--
<foam model="Model" name="DemoView" extendsModel="DetailView">
  <templates>
     <template name="toHTML"><code>
       <h2>$$description{mode:'read-only'}<h2>
       <div class="code">$$code{mode:'read-only'}</div>
       <div class="results">$$results</div>
     </code></template>
  </templates>
</foam>
-->

<foam model="UnitTest" onInit="this.test()" view="DemoView">
  <description>A UnitTest embedded in DOM</description>
  <code>
    this.log('Here I am.');
    this.log('And here.');
  </code>
  <tests>
    <foam model="UnitTest" description="SubTest1"><code>
    this.log('sub test 1, part 1');
    this.log('sub test 1, part 2');
    </code></foam>
    <foam model="UnitTest" description="SubTest2"><code>
    this.log('sub test 2');
    </code></foam>
  </tests>
</foam>

<foam model="UnitTest" onInit="this.test()" view="DemoView">
  <description>A failed Test</description>
  <code>
    this.fail("Something's wrong.");
  </code>
</foam>

<foam model="UnitTest" onInit="this.test()" view="DemoView">
  <description>DAO Tests</description>
  <code>
    // First, create a Model (like a schema)
    var Person = FOAM({
    model_: 'Model',
    name: 'Person',
    properties: [
    { name: 'id' },
    { name: 'name' },
    { name: 'sex', defaultValue: 'M' },
    { model_: 'IntegerProperty', name: 'age' }
    ]
    });
    
    var dao = MDAO.create({model: Person})
    .addIndex(Person.NAME)
    .addIndex(Person.SEX, Person.AGE);
</code>
  <tests>
    <foam model="UnitTest" description="SubTest1"><code>
        var dao = [];
        // Add some People
        dao.put(Person.create({id:'1', name:'John',  age:21}));
        dao.put(Person.create({id:'2', name:'Dave',  age:20}));
        dao.put(Person.create({id:'3', name:'Steve', age:19}));
        dao.put(Person.create({id:'4', name:'Andy',  age:18}));
        
        // Select to a 'sink'
        var log = this.log.bind(this);
        dao.select({put: function(p) { log('person: ', p.name); }});
    </code></foam>
    <foam model="UnitTest" description="SubTest2"><code>
        var dao = [];
        // Select directly to an Array
        var a = [];
        dao.select(a);
        this.log(a);
    </code></foam>
  </tests>
</foam>

<script language="javascript">
  arequire('DemoView')(function() {
    DOM.init(document);
 });
</script>
 </body>
</html>
